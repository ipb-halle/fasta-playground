<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:b="http://bootsfaces.net/ui" xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Library search with FASTA</title>
	<h:outputStylesheet library="css" name="styles.css" />
</h:head>
<h:body>
	<b:container>
		<h1>Sequence library search with the FASTA program</h1>
		<h2>Input</h2>
		<br />
		<b:form>
			<b:panelGrid col-spans="9,3">
				<h:panelGroup>
					<b:inputTextarea id="libraryId"
						value="#{fastaLibrarySearchBean.library}" required="true"
						label="Sequence library (DNA, RNA or AA)"
						placeholder="Paste or drag and drop library sequences in FASTA format here ..." />
					<b:message for="@previous" />
				</h:panelGroup>
				<h:panelGroup>
					<br />
					<b:commandButton value="Insert example protein library" ajax="true"
						process="@this" update="libraryId" immediate="true"
						action="#{fastaLibrarySearchBean.actionInsertProteinLibrary()}" />
					<br />
					<b:commandButton value="Insert example DNA library" ajax="true"
						process="@this" update="libraryId" immediate="true"
						action="#{fastaLibrarySearchBean.actionInsertDNALibrary()}" />
				</h:panelGroup>
				<h:panelGroup>
					<b:inputTextarea value="#{fastaLibrarySearchBean.query}"
						required="true" label="Query sequence"
						placeholder="Paste or drag and drop a query sequence in FASTA format here ..." />
					<b:message for="@previous" />
				</h:panelGroup>
				<b:commandButton value="Search"
					action="#{fastaLibrarySearchBean.actionSearch()}" ajax="true"
					process="@form" update="@form resultsId fastaOutputId"
					look="primary" />
			</b:panelGrid>
			<hr />
			<h2>Results</h2>
			<p:accordionPanel id="resultsId"
				value="#{fastaLibrarySearchBean.results}" var="result"
				varStatus="status" multiple="true">
				<p:tab
					title="Result #{status.index + 1}/#{status.end}: #{result.fastaResult.subjectSequenceName} #{result.fastaResult.subjectSequenceDescription}">
					<b:panelGrid col-spans="2,1,2,2,2,2,1">
						<h:commandLink value="Download FASTA"
							action="#{fastaLibrarySearchBean.actionDownloadFasta(result, status.index + 1)}" />
						<h:outputText value="Bit Score" />
						<h:outputText value="E()-Value" />
						<h:outputText value="Smith-Waterman Score" />
						<h:outputText value="Identity" />
						<h:outputText value="Similarity (Positives)" />
						<h:outputText value="Overlap" />
						<h:outputText />
						<h:outputText value="#{result.fastaResult.bitScore}" />
						<h:outputText value="#{result.fastaResult.expectationValue}" />
						<h:outputText value="#{result.fastaResult.smithWatermanScore}" />
						<h:outputText value="#{result.fastaResult.identity}" />
						<h:outputText value="#{result.fastaResult.similarity}" />
						<h:outputText value="#{result.fastaResult.overlap}" />
					</b:panelGrid>
					<hr />
					<b:row>
						<b:column span="11" offset="1">
							<h:outputText value="#{result.alignments}"
								style="white-space:pre; font-family:monospace;" />
						</b:column>
					</b:row>
				</p:tab>
			</p:accordionPanel>
			<hr />
			<h2>FASTA program output</h2>
			<h:outputText id="fastaOutputId"
				value="#{fastaLibrarySearchBean.fastaOutput}"
				style="white-space:pre; font-family:monospace;" />
		</b:form>
	</b:container>
</h:body>
</html>